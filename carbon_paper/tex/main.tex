% mnras_template.tex 
%
% LaTeX template for creating an MNRAS paper
%
% v3.0 released 14 May 2015
% (version numbers match those of mnras.cls)
%
% Copyright (C) Royal Astronomical Society 2015
% Authors:
% Keith T. Smith (Royal Astronomical Society)

% Change log
%
% v3.0 May 2015
%    Renamed to match the new package name
%    Version number matches mnras.cls
%    A few minor tweaks to wording
% v1.0 September 2013
%    Beta testing only - never publicly released
%    First version: a simple (ish) template for creating an MNRAS paper

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Basic setup. Most papers should leave these options alone.
\documentclass[fleqn,
%onecolumn,
%doublespacing, % this line changes to double-spaced 1 column
%referee,
usenatbib]{mnras}


% MNRAS is set in Times font. If you don't have this installed (most LaTeX
% installations will be fine) or prefer the old Computer Modern fonts, comment
% out the following line
\usepackage{newtxtext,newtxmath}
\usepackage{anyfontsize}
% Depending on your LaTeX fonts installation, you might get better results with one of these:
%\usepackage{mathptmx}
%\usepackage{txfonts}

% Use vector fonts, so it zooms properly in on-screen viewing software
% Don't change these lines unless you know what you are doing
\usepackage[T1]{fontenc}

% Allow "Thomas van Noord" and "Simon de Laguarde" and alike to be sorted by "N" and "L" etc. in the bibliography.
% Write the name in the bibliography as "\VAN{Noord}{Van}{van} Noord, Thomas"


%%%%% AUTHORS - PLACE YOUR OWN PACKAGES HERE %%%%%

% Only include extra packages if you really need them. Common packages are:
\usepackage{graphicx}	% Including figure files
\usepackage{amsmath}	% Advanced maths commands
% \usepackage{amssymb}	% Extra maths symbols
\usepackage{hyperref}
\usepackage[normalem]{ulem}
\usepackage[dvipsnames]{xcolor}
% \usepackage{enumitem}

\usepackage{tikz}


\graphicspath{{figures/}} 
% \linespread{1.8}




% enable line numbers
\usepackage{lineno}
%\linenumbers


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%% AUTHORS - PLACE YOUR OWN COMMANDS HERE %%%%%

% Please keep new commands to a minimum, and use \newcommand not \def to avoid
% overwriting existing commands. Example:
%\newcommand{\pcm}{\,cm$^{-2}$}	% per cm-squared


% citations
\defcitealias{james+21}{J21}
\newcommand{\JJ}{\citetalias{james+21}}
\newcommand{\VICE}{\textsc{vice}}


\newcommand{\fruity}{\texttt{\hyperlink{fruity}{Fruity}}}
\newcommand{\nugrid}{\texttt{\hyperlink{nugrid}{NuGrid}}}
\newcommand{\monash}{\texttt{\hyperlink{monash}{Monash}}}
\newcommand{\aton}{\texttt{\hyperlink{aton}{ATON}}}
\newcommand{\cfactor}{2.57}
\newcommand{\zetaobest}{1.90 \pm 0.10}
\newcommand{\zetaibest}{2.28 \pm 0.16}

\newcommand{\nsubgiants}{14,066}

% displays fractions within fractions well
\newcommand{\ddfrac}[2]{\ensuremath{%
    \frac{\displaystyle{#1}}{\displaystyle{#2}}
}}



% Acronyms
\newcommand{\agb}{AGB}
\newcommand{\apogee}{APOGEE}
\newcommand{\aspcap}{\textsc{aspcap}}
\newcommand{\cc}{CCSN}
\newcommand{\gce}{GCE}
\newcommand{\ia}{SN Ia}

% internal abbreviations
\newcommand{\caah}{[C/Mg]-[Mg/H]}
\newcommand{\caafe}{[C/Mg]-[Mg/Fe]}
\newcommand{\oh}{{\rm [O/H]}}
\newcommand{\mgh}{{\rm [Mg/H]}}
\newcommand{\cmg}{{\rm [C/Mg]}}
\newcommand{\co}{{\rm [C/O]}}
\newcommand{\mgfe}{{\rm [Mg/Fe]}}

\newcommand{\Var}{\operatorname{Var}}

\newcommand{\Hii}{H~{\sc ii}}


% other

\makeatletter
\newcommand{\C}[1][\@nil]{
    \def\tmp{#1}%
    \ifx\tmp\@nnil%
        \ensuremath{\rm C}%
    \else%
        \ifmmode ^{#1}{\rm C}%
        \else $^{#1}$C%
        \fi%
\fi }
\makeatother

\newcommand{\Yct}{{y_{\rm C}^{\rm  tot}}}
\newcommand{\Ycc}{{y_{\rm C}^{\rm CC}}}
\newcommand{\Ymg}{{y_{\rm Mg}^{\rm CC}}}
\newcommand{\Ycagb}{{y_{\rm C}^{\rm AGB}}}
\newcommand{\ycagb}{\y_{\rm C}^{\rm AGB}}
\newcommand{\y}{p}

\newcommand{\aagb}{\beta_{\rm C}^{\rm AGB}}
\newcommand{\fagb}{f_{\rm C}^{\rm AGB}}
\newcommand{\yo}{y_0}
\newcommand{\yl}{y_{\rm low}}
\newcommand{\zcc}{\zeta_{\rm C}^{\rm CC}}

\newcommand{\Mo}{ {\rm M}_{\sun}}
\newcommand{\Zo}{ Z_{\sun}}

\newcommand{\about}[1]{${\sim} #1$}


%%% citepos command
\makeatletter
\DeclareRobustCommand\citepos
  {\begingroup
   \let\NAT@nmfmt\NAT@posfmt% ...except with a different name format
   \NAT@swafalse\let\NAT@ctype\z@\NAT@partrue
   \@ifstar{\NAT@fulltrue\NAT@citetp}{\NAT@fullfalse\NAT@citetp}}

\let\NAT@orig@nmfmt\NAT@nmfmt
\def\NAT@posfmt#1{\NAT@orig@nmfmt{#1's}}

\makeatother


% Caption macros
\newcommand{\captionline}[2][very
thick]{\tikz[baseline={([yshift=-.5ex]current bounding box.base)}]{
\draw[#2,#1, line cap=round] (0,0) -- (0.3,0); }}




%%%%%%%%%%% JWJ' editing macros %%%%%%%%%%%
\newcommand{\red}[1]{{\color{red} #1}}
\newcommand{\strike}[1]{{\color{red} \sout{#1}}}
% \newcommand{\add}[1]{{\color{ForestGreen} #1}}
% \newcommand{\note}[1]{{\color{ForestGreen} \textit{ \small (JWJ: #1)}}}
% \LetLtxMacro\origcitep\citep
% \LetLtxMacro\origcitet\citet
% \renewcommand{\citep}[2][]{%
%     \mbox{\origcitep[#1][]{#2}}
% }
% \renewcommand{\citet}[2][]{%
%     \mbox{\origcitet[#1][]{#2}}
% }

\newcommand{\dbstrike}[1]{{\color{Thistle} \sout{#1} }}
\newcommand{\dbadd}[1]{{\color{Thistle} #1}}
\newcommand{\dbnote}[1]{ {\color{Thistle} \textit{\small (DB: #1)}} }





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%% TITLE PAGE %%%%%%%%%%%%%%%%%%%

% Title of the paper, and the short title which is used in the headers.
% Keep the title short and informative.
\title[The origin and galactic evolution of carbon]{The galactic chemical evolution of carbon: Implications for stellar nucleosynthesis}

% The list of authors, and the short list which is used in the headers.
% If you need two or more lines of authors, add an extra line using \newauthor
\author[D. A. Boyea et. al.]{%
Daniel A. Boyea,$^{1, 2, 3}$\thanks{%
Contact e-mail:~\href{mailto:danielaboyea@gmail.com}{danielaboyea@gmail.com}}
James W. Johnson,$^{1, 2, 4}$
and others
%David H. Weinberg,$^{1,2}$
%Jennifer A. Johnson,$^{1,2}$
%Falk Herwig$^{3}$
\\
% List of institutions
$^{1}$Department of Astronomy, The Ohio State University, 140 W. 18th Ave., Columbus, OH, 43210, USA
\\
$^{2}$Center for Cosmology \& Astroparticle Physics (CCAPP), The Ohio State University, 191 W. Woodruff Ave., Columbus, OH, 43210, USA
\\
$^{3}$Department of Physics \& Astronomy, University of Victoria, Victoria, BC V8P 5C2, Canada
\\
$^{4}$The Observatories of the Carnegie Institution for Science, 813 Santa Barbara St., Pasadena, CA, 91101, USA
}

% These dates will be filled out by the publisher
\date{Accepted XXX. Received YYY; in original form ZZZ}

% Enter the current year, for the copyright statements etc.
\pubyear{2025}

% Don't change these lines
\begin{document}
\label{firstpage}
\pagerange{\pageref{firstpage}--\pageref{lastpage}}
\maketitle



% Abstract of the paper
\begin{abstract}
Carbon (C) is thought to be produced by both core collapse supernovae (CCSN) and asymptotic giant branch (AGB) stars, but the relative contributions of these two sources are uncertain. 
% goals
We investigate the astrophysical origin of C using models of Galactic chemical evolution (GCE) appropriate for the Milky Way disk.
We benchmark our results against APOGEE subgiant abundances.
% results
The trend between [C/Mg] and [Mg/H] is set by the total C yield as a function of metallicity. Observations indicate a gently rising [C/Mg] with [Mg/H], but AGB C production is predicted to decline with metallicity. 
Our sample therefore favours a scenario in which CCSN yields rise with metallicity to offset declining AGB C yields and drive a subtle increase in [C/Mg] with [Mg/H].
This result is consistent with massive star nucleosynthesis models incorporating rotation.
%
The [C/Mg]-[Mg/Fe] trend is sensitive to delayed enrichment and therefore constrains the amount of AGB C production.
Given the slope of this relation, we find that AGB stars likely account for 10--40 per cent of C at solar metallicity.
% nuance
Artificially shifting the AGB C yields to lower masses also improves agreement with the [C/Mg]-[Mg/Fe] trend, possibly indicating a discrepancy with stellar evolution predictions or our assumed Fe production rate.
\end{abstract}

\begin{keywords}
galaxies: abundances -- galaxies: evolution -- galaxies: star formation -- galaxies: stellar content -- methods: numerical
\end{keywords}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%% BODY OF PAPER %%%%%%%%%%%%%%%%%%

\section{Introduction}


\begin{figure*}
    \centering
    \includegraphics{subgiants.pdf}
    \caption{The [C/Mg] ratio versus [Mg/H] (left) and [Mg/Fe] (right) for the \citet{jack}~sample of \apogee{} subgiants. {\bf Left:} High- and low-$\alpha$ stars are shown in blue and orange, respectively, using the separation defined in Eq.~\ref{eq:high_alpha}. The black points represent the median trend along the low-$\alpha$ sequence. {\bf Right:} Stars are colour-coded by their [Mg/H] abundance. The black points show the median [C/Mg]-[Mg/Fe] sequence for stars in the $-0.15 \leq [{\rm Mg/H}] \leq -0.05$ range. We use these median trends as our empirical benchmark in subsequent figures. } \label{fig:subgiants}
\end{figure*}



Despite being the second most abundant metal in the Universe~\citep[e.g.,][]{magg+22}, the nucleosynthetic origin of C is poorly understood. 
There is broad agreement that both massive and asymptotic giant branch (AGB) stars produce C \citep[e.g.,][]{jennifer19}, but their relative yields are disputed (see, e.g., the reviews by \citealt{romano22} and \citealt{RM21}). 
From a Galactic chemical evolution (GCE) perspective, some authors have argued that massive stars should dominate~\citep[e.g.,][]{prantzos+94, HEK00, romano+20, franchini+20, gustafsson22}, and others have argued that AGB stars should contribute a majority of C in the Universe~\citep[e.g.,][]{tinsley79, chiappini+03, mattsson10, KKU11, KKL20}. In addition, some studies like \citet{rybizki+17} find that AGB stars may produce about 20 to 50 per cent of solar C depending on the yield tables assumed.
In this paper, we aim to constrain C production by comparing abundance measurements in subgiant stars with multi-zone GCE models.%



Predictions of C yields from stellar evolution and supernova (SN) models are uncertain for numerous reasons (see, e.g., the reviews by \citealt{romano+10, KL14}).
Some prominent unknowns include mass loss rates \citep{sukhbold+16, beasor+2020}, rotational mixing \citep{frischknecht+16, LC18}, nuclear reaction rates \citep{herwig+05, herwig+austin2004}, and convection \citep{chieffi2001, ventura+13, issa+25}.
Recent work additionally suggests that small changes in a star's initial mass of 
${\sim}0.01\,\Mo$  have significant effects on the evolution and explosion outcomes of massive stars \citep{bruenn+2023, vartanyan_burrows2023}. Most yield tables have far courser initial-mass resolution.  Furthermore, many stars are found in binary systems \citep{sana+12}, the effects of which are almost entirely
unexplored in stellar nucleosynthesis models \citep{farmer+21}.
Robust predictions of metal yields from stellar evolution models therefore remain elusive.

Given the challenge of theoretical yield predictions, previous work has attempted to constrain chemical yields empirically. 
Even early chemical evolution work, such as \citet{garnett1997}, began to test stellar theory with observed abundance trends.
More recently, \citet{weinberg+19, weinberg+22} analysed the abundance ratio trends of high- and low-$\alpha$ sequence stars in APOGEE~\citep{apogee17} to infer relative yields of prompt and delayed enrichment sources and their metallicity dependence.
\citet{emily+19, emily+22, emily+24} applied the same methodology to GALAH~\citep{DeSilva2015, Martell2017}. In addition, models such as \citet{eitner+2020} and \citet{dubay+24} have used abundance trends of Fe and related elements to understand the physics and origin of \ia.
Most directly relevant to our analysis, \citet{james+24} applied Milky Way chemical evolution models to N and recommended a yield prescription that reproduces the observed relation between N and O abundances. We  extend their methodology to C in this paper.

% \citet{rodriguez+21, rodriguez+23} measured the mean Fe yield of core-collapse supernovae (CCSN) using the radioactive tails of their lightcurves.
% Their measurements, provide one of few empirical anchors on the absolute scale of yields \citep{david_fe}.



We use a sample of subgiant stars from APOGEE \citep{apogee17} as our primary observational constraint.
%This provide a large, homogeneous sample of well-measured C abundances unaffected by stellar evolution.
Subgiants' photospheric C abundance closely matches their birth composition \citep{gilroy89, korn+07, lind+08, souto+18, souto19}.
In other evolutionary phases, the measured abundances are known to be affected by internal processes (see discussion in Section~\ref{sec:data_selection} below).
Our sample should therefore be unaffected by uncertainties in inferring birth abundances.


In Section~\ref{sec:data_selection} we describe the selection for our subgiant observational sample.
In Section~\ref{sec:nucleosynthesis}, we discuss theoretical estimates of \agb\ and \cc\ C yields.
In Section~\ref{sec:vice}, we describe the details of our GCE models.
In Section~\ref{sec:results}, we present our model predictions and discuss their observationally distinguishable predictions. 
We then infer constraints on yield parameters in Section~\ref{sec:mcmc}.
In Section~\ref{sec:gas}, we compare our model to observations of halo stars and extragalactic \Hii{} regions from the literature. 
We summarize our conclusions in Section~\ref{sec:conclusions}.





% \footnotetext{\strike{By metallicity, we mean the (mass) fraction of any element which is not H or He, denoted by $Z$. For the sun, we take $\Zo=0.0176$.} }


\section{The Subgiant Sample}\label{sec:data_selection}




% Subgiants are a useful empirical benchmark because their photospheric abundances should reflect their birth mixture. 
We use subgiant stars as our empirical benchmark.
Subgiants have the advantage that their photospheric C and N abundances should closely approximate their birth mixture.
During main sequence evolution, metals can fall below the convective envelope (\textit{gravitational settling}; e.g., \citealt{turncotte+98}).
When stars evolve off the main sequence and become subgiants, these metals are reincorporated into the convective envelope \citep[]{gratton+00, souto19}. 
However, once a star becomes a red giant, \textit{first dredge up} pollutes its photosphere with CNO-processed material from the core \citep{iben67, KL14}. 


We use the sample of \apogee\ DR17 subgiants from \citet{jack}. We select stars from the ASPCAP pipeline (revision 1) within the $\log g$-$T_\text{eff}$ polygon given by
 \begin{equation}
    \begin{cases} \label{eq:subgiant_selection}
        \log \text{g} \geq 3.5 \\
        \log \text{g} \leq 0.004\,T_{\rm eff} - 15.7 \\
        \log \text{g} \leq 0.0007\,T_{\rm eff} + 0.36 \\
        \log \text{g} \leq -0.0015\,T_{\rm eff} + 12.05 \\
        \log \text{g} \geq 0.0012\,T_{\rm eff} - 2.8. \\
    \end{cases}
\end{equation}
Following \citet{jack}, we also exclude stars with the flags:
        \verb|APOGEE_MIRCLUSTER_STAR|,
        \verb|APOGEE_EMISSION_STAR|,
        \verb|APOGEE_EMBEDDEDCLUSTER_STAR|,
        \verb|APOGEE2_YOUNG_CLUSTER|,
        \verb|APOGEE2_W345|,
        \verb|APOGEE2_EB|, and
        \verb|DUPLICATE|.
We additionally remove stars with no reported (or flagged unreliable) C, N, Mg, or Fe abundances. These cuts yield a sample containing \nsubgiants\ subgiants.


Fig.~\ref{fig:subgiants} shows the [C/Mg] abundance ratios of our subgiant sample as a function of [Mg/H] and [Mg/Fe].\footnotemark{} In this sample, [C/Mg] increases with [Mg/H], and [C/Mg] decreases with [Mg/Fe] at fixed [Mg/H].
Following \citet[eq.~1]{jack}, low-$\alpha$ stars are defined to have 
\begin{equation}\label{eq:high_alpha}
\begin{cases}
\text{[Mg/Fe]} <0.16-0.13\,\text{[Fe/H]}, & \text{[Fe/H]}<0\\
\text{[Mg/Fe]} <0.16, & \text{[Fe/H]}>0. \\
\end{cases}
\end{equation}
Compared to the low-$\alpha$ sequence in \caah, the high-$\alpha$ sequence has a systematically lower [C/Mg] value and steeper slope. This is consistent with the shape of the \caafe{} trend.
Note that the \caafe{} trend follows a two-component linear distribution, with a separation in [Mg/Fe] corresponding to the gap between high- and low-$\alpha$ stars. Additionally, the \caafe{} trend is approximately independent of metallicity. We aim to reproduce these trends in our GCE models.

\footnotetext{In this paper, we use the standard notation for chemical abundances. $[A/B] = \log_{10}\left(A/B\right) - \log_{10}\left(A_{\sun}/B_{\sun}\right)$, i.e. $[A/B]$ is the logarithm of the mass ratio between A and B, scaled such that $[A/B]=0$ for the Sun (see Table~\ref{tab:fiducial_mod} for solar scale.) 
}

While any abundance trend likely suffers from systematic biases, we find that these biases do not impact our qualitative conclusions. 
We have also consider subgiants and dwarfs with similar selection criteria from GALAH DR4 \citep{galah_dr4}, Gaia-ESO DR5.1 \citep{gaiaeso_dr5.1}, LAMOST \citep{lamost}, and mixing-corrected APOGEE giants \citep{vincenzo+21}. 
All of these samples show similar trends in \caah\ and \caafe{}, but with global systematic offsets of ${\sim} 0.1\,{\rm dex}$ and slight differences in the slope of each trend. Global offsets would affect our inferred total C trend with metallicity. However, given that the \caafe{} trend is similar among different surveys, we would recover similar results for the inferred relative contribution of AGB stars to C production (Section~\ref{sec:mcmc_results}). Our results should therefore be robust against systematic differences between these surveys.



\section{Carbon Nucleosynthesis}\label{sec:nucleosynthesis}
Here, we review the processes that produce C in both high- and low-mass stars. We define yields as used in this paper and discuss the physics, predictions, and uncertainties from stellar model predictions. Our yield assumptions for other elements are presented in Section~\ref{sec:vice}. 

A yield quantifies the new production of a chemical species. For a given star, we define the {\it stellar yield of $X$} as the fraction of a star's initial mass synthesized into an element $X$ and released.  Specifically, we use {\it net} yields here, which subtracts the birth abundance of a chemical element from the ejected material. Net yields may become negative if more $X$ is transformed into other elements or locked inside the remnant than is produced. In contrast, a {\it gross} yield is the total mass of an element ejected over the star's lifetime and is always non-negative.
 We also describe yields by their population-averaged quantities, or {\it integrated yields}, which refer to the amount of newly produced $X$ per unit mass of star formation. These yields are calculated from the stellar mass-weighted average of net stellar yields over the initial mass function (IMF). 


\subsection{Low and intermediate mass stars}\label{sec:agb}

\begin{figure*}
    \centering
 	    \includegraphics[scale=1]{agb_yields.pdf}
        \caption[]{The net fractional C yield from AGB stars as a function of initial stellar mass and metallicity. Each panel represents yields from one of four \agb\ studies from the literature: \fruity{}, \aton{}, \monash{}, \nugrid{} (see Section \ref{sec:agb}).  The black dotted line shows $\Ycagb=0$ for reference. 
        }

        \label{fig:y_agb}
\end{figure*}

\begin{figure*}
    \centering
    \includegraphics{y_agb_vs_z_shifted.pdf}
    \includegraphics{y_agb_vs_t_shifted.pdf}

    \caption[]{
        \textbf{Left:} The integrated C yield from AGB stars, $\Ycagb$, as a function of metallicity for each yield table,  calculated $10\,{\rm Gyr}$ after a stellar population forms. (Note that the shape of the integrated yields arises from our linear interpolation of yields in $Z$. Changing to interpolation linear in $\log Z$ does not substantially affect our results.)
        \textbf{Right:} Cumulative C production as a function of age for a single stellar population of metallicity $\log Z/\Zo=-0.1$. The dashed black line shows the cumulative return fraction of type Ia supernovae ($\propto t^{-1.1}$) for comparison. The cumulative production of \aton{} reaches a minimum of -3 at a time of 0.3 Gyr.
}

   \label{fig:agb-ssp}

\end{figure*}


An asymptotic giant branch (AGB) star is a low to intermediate mass star undergoing He shell burning, its last nuclear burning phase (see e.g., \citealt{PR2023}). AGB stars enrich the interstellar medium (ISM) by expelling processed material during thermal pulses. 


We explore four different AGB star yield tables from the literature, which provide well-sampled grids in mass and metallicity. We refer to the tables as 
\begin{description}
    \item \hypertarget{fruity}{\texttt{FRUITY}}: \citet{cristallo+11, cristallo+15}
    \item \hypertarget{aton}{\texttt{ATON}}: \citet{ventura+13,ventura+14,ventura+18, ventura+20}
    \item \hypertarget{monash}{\texttt{Monash}}: \citet{KL16, karakas+18}
    \item \hypertarget{nugrid}{\texttt{NuGrid}}: \citet{pignatari+16, ritter+18, battino+19, battino+21}
\end{description}
Each AGB yield table reports yields for stellar models on a grid of masses and metallicities as reported in Table~\ref{tab:agb}.
We use the same tables as \citet{james+23}, except that we have swapped \citet{karakas10} for \citet{pignatari+16}. (See Appendix~\ref{sec:nugrid_yields} for the implementation and recalculation of these yields.)
For our models to better match observations, we uniformly amplify the yield tables according to
\begin{equation} \label{eq:alpha}
        \ycagb(m, Z) \rightarrow \aagb\ \ycagb(m, Z).
\end{equation}
As our fiducial \agb\ yield, we use the \fruity\ table with $\aagb=\cfactor$, (balancing MW and gas-phase constraints; see Section~\ref{sec:results} and Section~\ref{sec:gas}).

Fig.~\ref{fig:y_agb} compares the C yields for these four AGB models, which we leave unmodified (i.e., $\aagb = 1$) for this comparison.
Most models agree on general yield trends in mass and metallicity.
C production peaks between masses of $\sim$ 2--4 $\Mo$. As metallicity increases, the net yield decreases and the mass of peak C production increases slightly. As a result, these models predict AGB C production to decrease and become more rapid with increasing metallicity.


To integrate AGB yields with \VICE, we linearly interpolate yield tables in both mass and metallicity. Below the smallest mass in a table, $\ycagb$ is linearly extrapolated to 0 at $1\,\Mo$ to avoid numerical artifacts. The population-averaged AGB star yield is calculated with 
\begin{equation} \label{eq:imf-agb-yield}
    y_{X}^{\rm AGB}(Z,\tau) = 
    \int^{u_{\rm AGB}}_{m_\textrm{post-AGB}(\tau)} 
    \y_{\rm X}(m, Z)\ 
    \frac{1}{A}\frac{dN}{dm}\ m\ dm ,
\end{equation}
where $u_{\rm AGB}=8\,\Mo$ is the maximum birth mass of an AGB star, $m_\textrm{post-AGB}(\tau)$ is the birth mass of stars which complete AGB evolution at age $\tau$, and $dN/dm$ is the initial mass function (IMF). The IMF normalization is $
    A := \int_l^u m \frac{dN}{dm} dm
$
where  $l=0.08\,\Mo$ and $u = 100\,\Mo$ are the assumed minimum and maximum mass of star formation. We assume a \citet{larson74} main sequence mass-lifetime-relationship. We take the total stellar lifetime (through post-AGB) to be $1.1\times$ the main sequence lifetime. Thus, the mass $m_\textrm{post-AGB}$ is slightly larger than the main-sequence turn-off mass.


The IMF-averaged yields computed from the literature tables differ in normalization and metallicity dependence.  
The left panel of Fig.~\ref{fig:agb-ssp} shows IMF-averaged C yields for each \agb\ model as a function of metallicity, computed at time $\tau = 10$ Gyr after the formation of a single stellar population.
The normalizations span a factor of \about{2} (e.g., between $6\times 10^{-4}$ and $12 \times 10^{-4}$ at $Z=0.33\,\Zo$).
Additionally, the slope varies by a factor of ${\sim}3$.
Both \nugrid{} and \aton{} predict non-monotonic C yields with $Z$, but modelling systematics may exceed the scale of non-monotonic features.
These variations are due to different choices of reaction rates, convection treatments, and mass-loss rates (see discussion below and \citealt{james+23}).



The right panel of Fig.~\ref{fig:agb-ssp} shows the time-dependence of C production by \agb\ stars in a single stellar population of metallicity ${\rm [M/H]} = -0.1$ as a function of age. 
As the mass range $2\,\Mo\lesssim M \lesssim 4\,\Mo$ is predicted to be most important for C production, half the yield is produced before \about{1}\,Gyr, similar to Fe production by \ia. 
\monash{} weights C production more heavily towards high-mass \agb\ stars, resulting in shorter delay times, whereas the \fruity\ model predicts a slightly longer time-scale of \about{1}\,Gyr. In any case, little to no C is produced more than 2\,Gyr after a star formation event. Fe production, in contrast, continues steadily for 10\,Gyr. 

In AGB stars, {third dredge up} (TDU) and {hot bottom burning} (HBB) are two competing processes driving C evolution.
TDU accompanies thermal pulses, where material from the CO core is mixed with the envelope, increasing surface C abundances 
later released to the ISM \citep{KL14}.  
HBB\ is the activation of the CNO cycle at the bottom of the convective envelope, which converts most C into N.
TDU increases C yields, while HBB decreases C. 
%Because the $^{14}$N proton capture is the slowest component of the CNO cycle, the CNO cycle converts nearly all \C[12] into $^{14}$N \citep{solar-fusion}.

% \footnotetext{
%     The CNO cycle is a series of proton-capture reactions with CNO elements resulting in energy generation and the creation of an $\alpha$ particle. $\C[12]({\rm p}, \gamma)
%     ^{13}{\rm N}(\beta^+, \nu_{\rm e})
%     ^{13}{\rm C}({\rm p}, \gamma)\allowbreak
%     ^{14}{\rm N}({\rm p}, \gamma)\allowbreak
%     ^{15}{\rm O}(\beta^+, \nu_{\rm e})\allowbreak
%     ^{15}{\rm N}({\rm p}, \alpha)
%     \C[12]$. 
% There are other less important minor branches of the CNO cycle
%  \citep{solar-fusion}.
% }


Both HBB and TDU result in mass and metallicity-dependent C yields. 
Lower mass stars ($\lesssim 1\,\Mo$)  do not experience (strong) TDU. As a result, C yields from these stars are affected only by first dredge-up, resulting in small net C yields \citep[table 1]{karakas10}.
Above ${\sim}1\,\Mo$, TDU becomes more important, enriching the outer layers with C.
In \agb\ stars more massive than ${\sim}5\,\Mo$, efficient HBB turns most of the \C[12] into $^{14}$N.
TDU is more efficient for compact, massive cores. HBB requires a more massive AGB star to reach sufficient temperatures at the base of the convective envelope to initiate the CNO cycle. Both processes are more efficient at low metallicity due to the lower opacities, hotter temperatures, and more compact internal structures. The details of each process are ultimately set by uncertain choices in stellar evolution models. 

% compactness causes stronger thin-shell instability
% C yields increase because TDU outweighs HBB when low Z.


The primary uncertainties in AGB stellar evolution are convection, nuclear reaction rates, and mass loss prescriptions.
\citet{ventura+15} compared the \aton{} and \monash{} models, finding that differences in yields are primarily driven by differences in mass-loss and convection prescriptions. \aton{} predicts strong HBB to set in ${\sim}1\,\Mo$ lower than in \monash{}, leading to much lower C yields.
Moreover, the $^{14}{\rm N}({\rm p},\gamma)^{15}{\rm O}$ reaction rate uncertainty causes a factor of 2 difference in predicted C yields \citep{herwig+austin2004, HAL2006}.
Mass-loss rates, convection, and extra mixing are not sufficiently well understood to be computed from first principles. Thus, most of the physics included in stellar modelling is empirically calibrated. 

Super AGB stars are the class of AGB stars with masses ${\sim}8$ to ${\sim}10\,\Mo$, which burn O into Si and Mg. While we neglect super-AGB stars in the discussion above, these stars are not predicted to be substantial producers of C, similar to high-mass AGB stars. From the \citet{doherty+14, doherty+14b} yield table (extending the \monash\ yields), the highest net fractional yield is only $-0.002$ for super solar metallicity, which would have a negligible impact on the integrated yield. Additionally, as discussed in Section~\ref{sec:agb_results} below, the short lifetimes of high-mass AGB and super-AGB stars imply that they minimally affect our conclusions and can be grouped with CCSN yields.

%\dbnote{also NUGRID... https://ui.adsabs.harvard.edu/abs/2012ApJ...757..132H/abstract, https://ui.adsabs.harvard.edu/abs/2016MNRAS.455.3848J/abstract}

For our comparisons later, we define the AGB yield fraction, 
\begin{equation}\label{eq:f_agb}
    \fagb := \frac{\Ycagb(\Zo)}{\Ycc(\Zo) + \Ycagb(\Zo)}.
    \end{equation}
This quantity should approximately represent the fraction of the Sun's birth C abundance originating from AGB stars. Although, since the Sun was not enriched entirely by solar metallicity predecessors, the equivalence of $\fagb{}$ to the yield ratio is not exact.

\begin{table*}
	\centering
    \caption[]{For each \agb\ yield set, the IMF-averaged \agb\ C yield at solar metallicity $y_{\rm C, 0}^{\rm AGB}$, the fraction of solar C produced in the model $f_\odot^{\rm AGB}$, and the masses and metallicities each yield table is sampled on.
    $f_{\sun}^{\rm AGB}$ is calculated based on $y_{\rm C, \sun}^{\rm AGB}$ assuming the fiducial total C yield of $\Yct = 26.7\times 10^{-4}$.
    }

	\label{tab:agb}
    \begin{tabular}{c  c  c p{4cm} p{4cm}} % four columns, alignment for each
		\hline 
        \agb\ table 
                & $y_{\rm C, \sun}^{\rm AGB}\times10^4$ %& y
                &  $f_{\sun}^{\rm AGB}$
                & masses ($\Mo$) & metallicities ($Z$)\\
        \hline
        \fruity 
                & 3.11
                & 0.12
                & 1.3, 1.5, 2, 2.5, 3, 4, 5, 6
                & 0.0001, 0.0003, 0.001, 0.002, 0.003, 0.006, 0.008, 0.01, 0.014, 0.02
                \\
        \aton 
                & -0.009
                & -0.0003
                & 1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5, 6, 6.5, 7
                & 0.0003, 0.001, 0.002, 0.004, 0.008, 0.014, 0.04
                \\
        \monash 
                &  2.96
                & 0.11& 1, 1.25, 1.5, 1.75, 2.25, 2.5, 2.75, 3, 3.25, 3.5, 3.75, 4, 4.5, 5, 5.5, 6, 7 
                & 0.0028, 0.007, 0.014, 0.03
                \\
        \nugrid 
                & 9.25
                &  0.35
                & 1, 1.65, 2, 3, 4, 5, 6, 7
                &  0.0001, 0.001, 0.006, 0.01, 0.02
                \\
		\hline
	\end{tabular}
\end{table*}




\subsection{Massive stars}


Massive stars form $^{12}$C in their cores through the triple-$\alpha$ reaction (He-burning), which is later released to the ISM through winds and supernovae. Both material ejected through stellar winds and through CCSN contribute to C production, although we refer to CCSN and massive star enrichment interchangeably.

We approximate massive star enrichment as occurring instantaneously after a star formation event. Under this approximation, the yield is a constant  of proportionality between the metal production rate and the SFR:
\begin{equation}
    \dot{M}_X^{\rm CC} = y_{X}^{\rm CC}\, \dot{M}_\star.
\end{equation}
The CCSN integrated yield is given by
\begin{equation}
y_{X}^{\rm CC} = \int_{l_{\rm CC}}^{u} \left[E(m) m_{X\rm, SN} + w_X - Z_X\,(m-m_{\rm rem})\right]\,\frac{1}{A} \frac{dN}{dm}\ dm,
\end{equation}
where $E(m)$ is the fraction of stars of mass $m$ which explode, $m_{X,\rm SN}$ is the mass of $X$ ejected during the CCSN, $w_X$ is the mass of $X$ ejected through stellar winds, $Z_X$ is the initial abundance of $X$, $m_{\rm rem}$ is the remnant mass, $dN/dm$ is the IMF, $l_{\rm CC}=8\,\Mo$ is the minimum initial mass of a CCSN progenitor, and $u$ is the maximum mass in the CCSN yield table. 

\cc{} models predict a wide range of C yields, spanning nearly a factor of ten, even at fixed metallicity.
Fig.~\ref{fig:y_cc} shows the integrated yields of massive star models from the literature. 
 The \cite{LC18} models, which include rotation, show that the induced mixing (e.g., \citealt{frischknecht+16}) can dramatically increase the magnitude and metallicity dependence of $\Ycc$. As we will later empirically show, \cc\ C production needs to be strongly metallicity-dependent at $Z \approx \Zo$, which is consistent with \citepos{LC18} rapidly rotating models and to a lesser extent \citet{NKT13}.
Fig.~\ref{fig:y_cc} also shows the IMF-averaged \agb\ star yields from the \fruity\ model (in Fig.~\ref{fig:agb-ssp}). Especially at $Z\approx \Zo$, most \cc\ models dominate \agb\ C production. 

If we consider CCSN production alone, the [C/Mg] ratio depends only on the yield ratio,
\begin{equation}\label{eq:c_mg_cc}
    {\rm [C/Mg]^{CC}} = \log_{10}\left( \frac{\Ycc}{\Ymg}\right) - \log_{10} \left( \frac{Z_{{\rm C},\ \sun }}{Z_{{\rm Mg},\ \sun }} \right).
\end{equation}
Because the yield ratio depends on metallicity, the abundance ratio will settle to an equilibrium that depends only on the equilibrium metallicity \citep{WAF17, james+23}. The right axis of Fig.~\ref{fig:y_cc} shows the  ${\rm [C/Mg]^{CC}}$ ratio for different CCSN C yields and our fiducial Mg yield. Different models have values of ${\rm [C/Mg]^{CC}}$ between $ -0.8$ and $+0.3$ at near-solar metallicity, illustrating the wide range of CCSN predictions. 


The metallicity dependence of CCSN C yields is due to an interplay between rotation, opacity, and stellar evolution. As opacity increases with metallicity, massive stars experience stronger winds. In particular, C-enriched envelope material is lost through winds before conversion into heavier elements, resulting in metallicity-dependent C production \citep{LC18}.
While there are many stellar models providing predictions of \cc{} yields, the results of these models are highly uncertain. Furthermore, rotation, binarity, and explodability introduce substantial uncertainties in \cc\ predictions \citep{farmer+21}.

We chose to adopt a linear yield model instead of a particular literature yield table, given the wide range of predictions for CCSN C. We parameterize the yield as
\begin{equation}\label{eq:y_cc}
    \Ycc =  \yo + \zcc \left(\frac{Z - \Zo}{\Zo}\right),
\end{equation}
where $\yo$ represents the yield at solar metallicity and $\zcc$ is the slope of the metallicity dependence. For our fiducial model, we adopt $\yo = 18.7\times 10^{-4}$ and $\zcc = 7.9 \times 10^{-4}$, leading to reasonable agreement with the \caah{}, \caafe{}, and gas-phase (Section~\ref{sec:gas}) relations. We present best-fitting models to subgiants only in Section~\ref{sec:mcmc_results}. We have also explored higher-order prescriptions (i.e., second-, third-, and fourth-order polynomials), finding improved agreement with the observed abundances with each successive free parameter.
The linear prescription likely does not fully capture C production by massive stars, but more complex models do not significantly alter our conclusions.

\begin{figure}
    \centering
    \includegraphics{cc_yields.pdf}
    \caption[]{
        IMF-integrated C yields from massive stars plotted as a function of metallicity.
        The right axis provides the equivalent CCSN [C/Mg]  ratio, assuming our fiducial $y_{\rm Mg}$ yield. The black line is our fiducial massive star yield (see Eq.~\ref{eq:y_cc}).
        Yields are shown for tables from \citet[LC18, blue circles]{LC18}, \nugrid{} (P16, orange hexagons),  \citet[S16, green square and diamond]{sukhbold+16},  \citet[NKT13, red stars]{NKT13}, and 
    \citet[WW95, pink triangles]{WW95}. \citet{sukhbold+16} report yields for different black hole landscapes, while \citet{LC18} provide yields at different rotational velocities.
   The pink line denotes $\Ycagb$ from the \fruity{} AGB star model for comparison (see Fig.~\ref{fig:agb-ssp}). All models include wind yields. 
}
    \label{fig:y_cc}
\end{figure}


\subsection{Other sources}

SN Ia produce negligible C. Of the models from \citet{iwamoto+99}, \citet{seitenzahl+13}, and \citet{gronow+21a, gronow+21b}, the maximum C production is less than 4 per cent of our required solar C yield, and most likely less than 2 per cent (assuming  $2.2\times 10^{-3}$ SN Ia explosions per solar mass of star formation; \citealt{maoz+mannucci12}).
Novae are important contributors of \C[13], but do not process enough material to impact \C[12] production \citep{starrfield+20}. \C[13] is beyond the scope of this work and accounts for a small fraction of the C in the Universe.


\section{The Multi-zone Model}\label{sec:vice}

Our models extend the \citet[hereafter \JJ]{james+21} Milky Way model. We integrate the model using the publicly available Versatile Integrator for Chemical Evolution (\VICE; \citealt{JW20}).%
    \footnote{\VICE~is available at \url{https://github.com/giganano/VICE}}
This model is described extensively in \JJ~and summarized in \citet{james+23}. Here, we provide an overview of the relevant components.

Classical \textit{one-zone} models of chemical evolution assume instantaneous mixing of metals in the star-forming ISM\ \citep[e.g.,][]{matteucci21}. The one-zone framework is a poor approximation of the Milky Way, where the radial metallicity gradient in the ISM is believed to reflect variations in GCE parameters \citep[e.g.,][]{tinsley80, boissier+prantzos99, palla+20, james+24}. Stars can also migrate several kpc over their lifetimes, mixing populations from different chemical environments across the Galaxy \citep{sellwood+binney02, schonrich-binney09, bird+13, minchev+13}. To account for these effects, multi-zone models stitch together multiple one-zone models while mixing stellar populations between zones \citep[e.g.,][]{matteucci+francois1989}.


In these models, the Galaxy is divided into 200 rings, each representing a single 100\,pc zone. Each ring has a separate stellar population and gas supply. We initially assume the inside-out SFH from \JJ, where the star formation surface density $\dot{\Sigma}_\star$ is given by 
\begin{equation}\label{eq:inside_out}
    \dot{\Sigma}_\star \propto \left(1-e^{-t/\tau_{\rm rise}}\right) e^{-t/\tau_{\rm sfh}}.
\end{equation}
The rise time $\tau_\text{rise}=2$\,Gyr loosely describes when the star formation rate reaches a maximum, and $\tau_{\rm sfh}$ describes the decay time-scale of star formation, which increases with radius $R$. \JJ\ derive $\tau_{\rm sfh}(R)$ to fit the stellar age gradients measured by \citet{sanches20} from integral field spectroscopic surveys. At each $R$, the SFH is normalized to match the stellar surface density profile \citep[from][]{BHG16} assuming a total stellar mass of $5.17\times10^{10}\,\Mo$ \citep{LM15}. Star formation ends beyond a radius $R=15.5\,$kpc, but stellar populations are allowed to migrate as far as $R=20\,$kpc.  
The gas inflow is calculated to maintain the SFH for each radius and time, using an extension of the Kennicutt-Schmidt law \citep{kennicutt98} motivated by the combined observations of \citet{bigiel+10} and \citet{leroy+13} (see \JJ).
The scaling of this relationship varies with time due to the redshift dependence of $\tau_\star$ in molecular gas observed by \citet{tacconi18}.

We use the radial migration prescription described in appendix C of \citet{dubay+24} and summarized in Section 3 of \citet{james+24}. The total distance each star moves is sampled from a normal distribution with standard deviation $\sigma_R =  2.68\,{\rm kpc} \ (R/8\,{\rm kpc})^{0.61}\,(\tau / 8\,{\rm Gyr})^{0.33}$. Stars migrate from their initial to their final positions with a cube-root time-dependence. 
These parameters arise from \citepos{dubay+24} analytic approximation of the {\tt h227} simulation \citep{bird+21, christensen+12, zolotov12, loebman12, BZ14}. 

Following \JJ{} (and more recently \citealt{james+24}), we control the slope of the radial metallicity gradient by adjusting the strength of the mass-loading in Galactic winds. The mass-loading, $\eta :=  \dot\Sigma_{\rm out} / \dot \Sigma_\star$, the ratio between the surface density rates of gas leaving the system and star formation, is set to
\begin{equation}\label{eq:mass_loading}
\eta(R) = \frac{y_{\rm Mg}^{\rm CC}}{Z_{\rm Mg}(R)} -1 + r %+ \tau_{\star} / \tau_{\rm sfh} 
\end{equation}
where 
\begin{equation}
    \log Z_{\rm Mg}(R) = \log Z_{\rm Mg,\ \sun} + 
    0.29 + 
    \begin{cases}
        -0.015(R-5) & R < 5 \\
        -0.09(R-5) & R \geq 5
    \end{cases}
\end{equation}
is adapted from \citet{hayden+14} assuming Mg is representative of $\alpha$ elements.
The recycling correction $r\approx 0.4$ accounts for the return of stellar envelopes back to the ISM (for a \citealt{kroupa01} IMF after 10 Gyr; see Section 2 from \citealt{WAF17}).
This choice of $\eta(R)$ results in a [$\alpha$/H] gradient consistent with APOGEE measurements \citep[e.g.,][]{hayden+14, weinberg+19, frinchaboy+13}.
Compared to \citet{james+21, james+24}, our metallicity gradient is flatter within 5 kpc (and our $\eta\to0$ at similar radius).
If we change our assumed yield scale, the values of $\eta$ will re-scale accordingly to maintain observationally-consistent chemical trends. Following \JJ, we neglect radial gas flows.

To create representative stellar samples to compare with APOGEE, 
we draw \nsubgiants\ stars from the simulated stellar populations. First, we draw a random zone (weighted by the number of observed subgiants in each zone) and then draw a random particle in the zone weighted by the stellar population mass.
Galactocentric radii are taken from astroNN \citep{leung+bovy19, leung+bovy19b} to derive the number of subgiants in each zone.  The choice of stellar selection function predominantly affects the metallicity distribution, but leaves abundance trends the same in this model.


Table~\ref{tab:fiducial_mod} summarizes our yield choices. 
Our solar abundance scale is from \citet{magg+22} with a 0.04 dex gravitational settling correction. Also from \citet{magg+22}, we adopt $\Zo = 0.0176$. We use the O, Mg, and Fe yields recommended by \citet{david_fe} based on measurements of the mean CCSN Fe yield \citep{rodriguez+21, rodriguez+23} and APOGEE chemical abundances.
Our AGB N yield is scaled from \citep[eq. 14]{james+23}, based on the differences in our assumed solar  N/O ratio. The CCSN N/O yield is additionally enhanced by a factor of 2.5 to account for the difference in median solar [N/Mg] values from \citet{vincenzo+21} and APOGEE subgiants. Following \citet{james+23}, we use a $t^{-1.1}$  delay time distribution (DTD) with a minimum delay-time of 150 Myr, based on comparisons of the SN Ia rate as a function of redshift and the cosmic SFR (e.g., \citealt{maoz+mannucci12}). We assume $2.2\times10^{-3}$ SN Ia events per unit mass of star formation with a mean $0.355\,\Mo$ of new Fe produced per supernova.
We use a \citet{kroupa01} initial mass function (IMF).



\begin{table}
	\centering
    \caption[]{Solar abundance scale and fiducial yields (in units of stellar population birth mass). See Section \ref{sec:agb} for the definition of \fruity. The solar abundance scale is \citet{magg+22} corrected upwards by 0.04 dex for gravitational settling and diffusion \citep{david_fe}.
    }
	\label{tab:fiducial_mod}

	\begin{tabular}{l l l l l}
		\hline
         $X$ & $Z_{X,\,\sun}$ & $y_X^{\rm cc}$ & $\y_X^{\rm agb}$ & $y_X^{\rm ia}$  \\
		\hline
        C & $33.9\times10^{-4}$ & Eq.~\ref{eq:y_cc} & $\cfactor\times$\fruity &  0 \\
        O & $73.3\times10^{-4}$ & $71.3\times10^{-4}$ & 0 & 0 \\
        Mg & $6.71\times10^{-4}$ & $6.52\times 10^{-4}$ & 0 & 0 \\
        Fe & $13.7\times10^{-4}$ & $4.73\times10^{-4}$ & 0 & $7.82\times10^{-4}$ \\
        N & $10.4\times10^{-4}$ & $5\times10^{-4}$ & $5\times10^{-4}M\left(\frac{Z}{\Zo}\right)$ & 0\\
		\hline
	\end{tabular}
\end{table}


\section{Results}\label{sec:results}

\subsection{Evolution and interpretation of carbon abundances}

\begin{figure*}
\centering
\includegraphics{figures/all_the_tracks.pdf}
\caption[]{
    Time evolution of gas-phase C abundances in our fiducial model for [C/Mg] versus [Mg/H] (left) and [Mg/Fe] (right).
    Each line represents a zone at a different Galactic radius, colour-coded by lookback time. We plot zones at 1 kpc intervals between 2 and 15 kpc. Evolution in [C/Mg] with [Mg/H] varies substantially between regions of the Galaxy, while evolution with [Mg/Fe] is more uniform.
}
\label{fig:c_evo}
\end{figure*}

Fig.~\ref{fig:c_evo} shows evolutionary tracks in \caah{} and \caafe{} in the fiducial model at 1\,kpc intervals of radius.
The \caah\ trend reaches an equilibrium state within \about{5}\,Gyr. \caafe\ tracks continue to evolve due to the long tail of the \ia\ DTD.

The evolution of chemical abundances can be understood as the interplay between different processes with different time-scales. 
 Initially, \cc\ dominate enrichment. The [C/Mg] abundance ratio is set by the relative yield $\Ycc/\Ymg$. Due to the metallicity dependence of $\Ycc$, [C/Mg] increases with  [Mg/H]. [Mg/H], [Fe/H], and [C/H] all rise rapidly. [Mg/Fe] is initially high due to the delayed production time-scales of SN Ia Fe, as expected from the analytic models of \citet{WAF17}.
 Of order 100 Myr later, delayed sources enrich the ISM. \agb\ stars release C, raising [C/Mg], and \ia\ expel Fe, lowering [Mg/Fe]. 
 Several Gyr later, [Mg/H] reaches equilibrium. As the metal abundance stabilizes, so do metallicity-dependent \cc{} yields, allowing C to reach equilibrium. [Fe/H] continues to rise slowly due to ongoing \ia\ from old stellar populations. 
 Finally, the system reaches approximate equilibrium and evolution slows. \
 
This evolution is predominantly driven by our chosen elemental yields, their
metallicity dependence, and their DTDs.
As we will demonstrate in Section~\ref{sec:agb_results} below, the final slope of the \caah\ trend depends mostly on the metallicity dependence of the total C yield. The \caafe{} trend instead reveals the nature of delayed C production.



%  Fig.~\ref{fig:c_evo} also shows the  equilibrium tracks in \caah\, and \caafe. Based on the \citepos{WAF17} analytic models of chemical equilibrium for constant star formation, the equilibrium abundance ratio between two elements depends only on the relative yields when the DTD is sufficiently prompt. For C/Mg, 
% \begin{equation}\label{eq:equilibrium_yields}
%     {\rm [C/Mg]_{eq}} :=  \log \left(\frac{\Ycc + \Ycagb }{y_{\rm Mg}}\right) - \log \left(\frac{Z_{\rm C,\,\sun}}{Z_{\rm Mg,\,\sun}}\right)
% \end{equation}
% As such, the equilibrium [C/Mg] represents the steady-state expectation due to C and Mg yields.
% However, in the \caafe\ plane, equilibrium [Mg/Fe] is single-valued, so equilibrium track is a vetical line representing the range of ${\rm [C/Mg]_{eq}}$ across metallicity. Therefore, the trends in \caafe\ are instead representative of the approach to equilibrium in C, Mg, and Fe.  \caafe\ is well approximated by either a single-stellar-population or a single zone model, since its slope is set by the C and Fe DTDs.
% 

\subsection{Nitrogen}


\begin{figure}
\centering
\includegraphics{figures/nitrogen.pdf}

\caption[]{The median low-$\alpha$ [C/N] ratio as a function of [Mg/H] for our fiducial model (blue line), compared with \apogee{} subgiants (medians as black points with 16th and 84th percentile ranges as grey bars). Stars are binned into 20 equal-number bins. Combining our results with the suggested N yield from \citet{james+23} \ (rescaled to our adopted yields) explains the thin-disk evolution of both C and N. 
}
\label{fig:nitrogen}
\end{figure}

N production, also affected by the CNO cycle, is closely tied to C.
This paper builds upon \citet{james+23}, who used similar methods to constrain N yields. As an additional test of both yield models, we combine a rescaled version of their recommended N yields (see discussion in Section~\ref{sec:vice}) with our fiducial choice of C yields.
Fig.~\ref{fig:nitrogen} shows [C/N] versus [Mg/H] as predicted by our fiducial model. We are indeed able to closely match the observed [C/N]-[Mg/H] trend.



\subsection{The high-mass yield slope and low-mass production fraction of C yields}\label{sec:yield_variations}
\label{sec:agb_results}

\begin{figure*}
    \includegraphics{sims_zeta_f.pdf}
    
    \caption[]{
        Trends in [C/Mg] with [Mg/H] (left) or [Mg/Fe] (right). 
        Stars are binned into 20 (left) or 12 (right) equal-number bins. 
        The left panel only shows low-$\alpha$ stars, and the right panel shows stars where $-0.15\leq \mgh \leq -0.05$.
        Coloured lines represent the median [C/Mg] in bins of [Mg/H] or [Mg/Fe] for each model.
        Black points and grey dashes represent the median and 16th-84th percentiles of [C/Mg] in each bin in the \citet{jack}~sample. 
        The total solar C yield is held fixed in each model. 
        %
        \textbf{Top}: Models with different slopes of the metallicity dependence of the CCSN yield, $\zcc$ (Eq.~\ref{eq:y_cc}), where higher $\zcc$ corresponds to a more rapid increase in C production with metallicity. \textbf{Middle}: Models with different fractions of solar C produced in AGB stars, $\fagb$. 
        \textbf{Bottom:} Models where both $\fagb$ and $\zcc$ are adjusted simultaneously. 
    }
    \label{fig:zeta_f}
\end{figure*}




The top row of Fig.~\ref{fig:zeta_f} shows models with varying strengths of the $\Ycc$ metallicity dependence, $\zcc$ (see Eq.~\ref{eq:y_cc}). With higher $\zcc$, the model predicts a steeper \caah\ trend, owing to the direct relationship between equilibrium [C/Mg] and yield ratios in Eq.~\ref{eq:c_mg_cc}. 
However, the \caafe{} trend is minimally affected by changes to $\zcc$ for stars at a given [Mg/H].
CCSN occur on much shorter time-scales than AGB and SN Ia enrichment.  The primary effect of increasing $\zcc$ in the \caafe{} plane, restricted to a metallicity slice, is to shift [C/Mg] uniformly. 


The middle row of Fig.~\ref{fig:zeta_f} shows three models with different C \agb\  fractions (Eq.~\ref{eq:f_agb}).
At fixed metallicity, the \caafe\ trend is principally sensitive to how much C and Fe come from delayed sources. In the limit $\fagb \to 0$, the [C/Mg] abundance will become nearly independent of [Mg/Fe]. As $\fagb$ increases, the steepness of the \caafe{} trend increases. 

Because both $\fagb{}$ and $\zcc$ affect the \caah{} trend, it is possible to vary both of these parameters and leave the \caah{} trend nearly untouched. 
The bottom row of Fig.~\ref{fig:zeta_f} illustrates this degeneracy.
While each model has substantially different AGB contributions, ranging from $\fagb = 0$ to $0.5$, adjustments to the massive-star C yield leave the \caah{} trend mostly unaffected. While some residual differences remain, these could be addressed with a CCSN yield model that more closely compensates for the AGB yield metallicity dependence. On the other hand, the differences between these models in the \caafe{} plane are far more stark, with the trend's total amplitude ranging from almost 0 (for $\fagb{} = 0$) to nearly 0.3 dex (for $\fagb{} = 0.5$). While these trends may appear different from those in the middle panel, they are mostly only shifted vertically.

Given these models, we can interpret the physical significance of each trend. The \caah{} trend (for low-$\alpha$ stars) tells us about the total C yield. This trend is mostly independent of where C is produced at a given metallicity, but is very sensitive to changes in the total C production. Models that match \caah{} trends alone would struggle to differentiate between different production mechanisms of C. The \caafe{} trend (for a given metallicity) tells us about delayed C production. For example, the models in Fig.~\ref{fig:zeta_f} with no delayed C predict a nearly flat trend in [C/Mg] with [Mg/Fe], even with metallicity-dependent C production. As such, the \caafe{} trend is a useful diagnostic of $\fagb$.


\subsection{AGB yield modifications}

All AGB yield tables predict a similarly shaped trend in the \caafe{} abundance space. The left panel of Fig.~\ref{fig:sims_degens} shows the best-fitting AGB yield models (see Section \ref{sec:mcmc} for methodology) for each yield table we consider. Interestingly, while the individual DTDs of each AGB table appear substantially different (Fig.~\ref{fig:agb-ssp}), these differences smooth out in terms of the predicted abundance trends. Altogether, changes to the \agb{} yield table appear to have minimal effects on predicted C trends. 

One potential tension, however, is the concavity of the \caafe{} relation: all \agb{} tables predict a slightly concave down trend. In contrast, the subgiants predict a nearly-linear C trend across all [Mg/Fe]. In addition, one of the most salient differences between models in the left panel of Fig.~\ref{fig:sims_degens} is that \aton{} and \monash{} predict an almost flat \caafe{} trend for ${\rm [Mg/Fe]} \lesssim 0.1$, in further tension with the data. As discussed in the next paragraph, this may indicate that C production should be weighted more towards even lower-mass stars. As an example, we shift the \fruity{} AGB yield table by a constant factor of 0.7 towards lower-mass AGB production. This shifted model predicts a more linear \caafe{} trend, in better agreement with observations. However, a GCE model better able to produce the abundance of high-$\alpha$ stars may be necessary to fully interpret this trend.
Alternatively, the Fe DTD could similarly be too extended in our models, though recent work suggests a yet more extended DTD than our assumption \citep{palicio+2024, dubay+24}. 

To further explore the impact of the C DTD on abundance trends, we artificially shift the \fruity{} AGB yield table by a factor in mass.
The middle panel of Fig.~\ref{fig:sims_degens} shows models shifting production towards lower masses (factors of 0.5 and 0.7) and higher masses (1.5). When the AGB C production is weighted towards more massive AGB stars, the DTD becomes more rapid, leading to higher [C/Mg] at high [Mg/Fe]. On the other hand, shifting the C production toward lower mass progenitors makes the DTD more extended. In Fig.~\ref{fig:sims_degens}, the models with AGB C shifted towards lower progenitor masses reduce or reverse the concavity of the \caafe\ trend. For the extreme case, where the progenitor masses are shifted by a factor of 0.5, the AGB production is more delayed than SN Ia, resulting in a concave up trend. The ideal progenitor mass shift is \about{0.7}, linearizing the \caafe\ trend to agree with observations and alleviate the disagreement in concavity seen in the left panel of Fig.~\ref{fig:sims_degens}. While our mass shift models are artificially simple, they illustrate that the observed \apogee{} trends would be better fit if AGB production were shifted towards longer-lived stars.


\subsection{Star formation history and yield scale } \label{sec:sfh} \label{sec:outflows}

\begin{figure*}
    \includegraphics{figures/zeta_f_mass_sfh.pdf}
    
    \caption[]{
        Similar to Fig.~\ref{fig:zeta_f}, but focusing on [C/Mg] versus [$\alpha$/Fe].
        {\bf Left:} The best-fitting model for each AGB table, and the best-fitting model from the middle panel with a mass shift of 0.7. 
        {\bf Middle:} Models where the \fruity{} \agb\ yields are artificially shifted by different multiplicative factors in progenitor mass, but maintaining the same $\fagb$. 
        {\bf Right:} Models with alternative star formation histories (Eqs.~\ref{eq:lateburst}, \ref{eq:twoinfall}), and a model where all yields are doubled (with mass-loading adjusted accordingly; see Section~\ref{sec:vice}).
    }
    \label{fig:sims_degens}
\end{figure*}

In the right-hand panel of Fig.~\ref{fig:sims_degens}, we consider two alternative SFHs.
Motivated by the findings of \citet{mor+19} and \citet[see discussion in \JJ]{isern19}, the \textit{lateburst} model adds a Gaussian-shaped burst to the fiducial inside-out model, 
\begin{equation}\label{eq:lateburst}
    \dot{\Sigma}_\text{lateburst} \propto \dot{\Sigma}_\text{inside-out} \left(1 + A\,e^{-(t-t_{\rm burst})^2/2\sigma^2_{\rm burst}} \right),
\end{equation}
where $A=1.5$ represents the amplitude of the birth, $t_\text{burst}=10.8$\,Gyr is the time where the burst is strongest, and $\sigma_\text{burst}=1$\,Gyr is the width of the burst.

We also consider a two-infall evolutionary history \citep[e.g.,][]{chiappini+97,spitoni19, spitoni21, spitoni+23}. This prescription posits that the majority of the stellar mass of the Galactic disk was built up during two events of substantial metal-poor accretion separated in time. The two-infall scenario offers a natural explanation \citep{spitoni19, spitoni21} for the bimodal distribution of [$\alpha$/Fe] ratios observed in the MW \citep[e.g.,][]{hayden+15}. However, the two-infall model has recently faced challenges when confronted with large catalogues of stellar age measurements \citep{dubay+24}. For these models, we switch \VICE{} to `infall mode' and let it compute the SFR from a specified accretion history, in contrast to the other models where we specify the SFH (see discussion in Section~\ref{sec:vice}). Our accretion history, following \citet{dubay+24}, is given by
\begin{equation}\label{eq:twoinfall}
\dot{\Sigma}_{\rm in} \propto e^{-t/\tau_1} + A \theta(t - t_{2}) e^{-t/\tau_2},
\end{equation}
where $\tau_1=1\,$Gyr, $\tau_2=4\,$Gyr control the duration of the first and second burst, $t_2=4$\,Gyr specifies the start of the second infall, from, $A$ is the relative amplitude of the second burst, and $\theta$ is the Heaviside step function. We chose $A(R)$ such that the ratio between the stellar mass produced in the first and second burst by $13.2\,{\rm Gyr}$ matches the ratio between the thin and thick disks from \citet{BHG16}.

The right panel of Fig.~\ref{fig:sims_degens} compares the fiducial, lateburst, and two-infall models. The differences in the \caafe\ trend are small. Each model predicts a different distribution in [Mg/Fe] as expected \citep[e.g.,][]{JW20}, but the relations between abundance ratios are largely unaffected by the assumed SFH. Variations due to the SFHs considered here are smaller than the width of the observed distribution.


Lastly, we demonstrate that our conclusions are unaffected by the assumed scale of stellar yields and mass loading in outflows.
The fiducial yield scale adopted here, from \citet{david_fe}, is relatively low, requiring only moderate outflows to reproduce solar metallicity. However, models with higher outflows and higher yields give similar predictions because of the 
strong degeneracy between the normalizations of elemental yields and mass-loading (see discussion in, e.g., \citealt{sandford+24} and Appendix B of \citealt{james+23}). 
Our parameterization of $\eta$ illustrates this point (see Eq.~\ref{eq:mass_loading}) -- choosing a higher value of $y_{\rm Mg}^{\rm CC}$ will similarly result in higher values of $\eta$ while maintaining the same metallicity gradient. 
In the right panel of Fig.~\ref{fig:sims_degens}, we consider a model in which all yields are doubled (and mass loading approximately doubled by Eq.~\ref{eq:mass_loading}). As expected, the trend in [C/Mg]-[Mg/Fe] is not significantly affected, showing that observed trends constrain the ratio of C yields to Mg yields.




\section{Yield Inference}\label{sec:mcmc}

Here, our goal is to convert the qualitative understanding from the last Section into more quantitative constraints on the yields. 
From the previous Section, we learn that:  the \caah{} trend tells us the overall total C yield metallicity dependence, and the \caafe{} trend tells us about the amount of delayed C and its DTD. We chose to construct Monte-Carlo Markov chain (MCMC) models to explore possible abundance combinations matching the observed trends. From these models, we can derive the distributions of likely properties of underlying C yields given our current observations.

\subsection{Monte-Carlo Markov Chain yield inference} \label{sec:mcmc_methods}


To efficiently explore a wide range of yield combinations, we can use this linearity to predict the abundances from linear combinations of yields through {\it process tracking}. In GCE, total elemental abundances are (to first order) linear with respect to combinations of yields \citep[e.g.,][]{WAF17}. The rate of change of an element's ISM mass is given by the sum of processes constant or linear in the element's abundance: material formed into stars, new production of elements, material returned from stars, and material lost through outflows. Thus, just as the yields of different elements can be treated as independent solutions, the yields of different processes can be solved independently and superimposed. In our process tracking method, we set up \VICE {} to integrate each process for C independently (by using tracer elements for each yield component). We then predict the stellar abundances from a given linear combination of yields $y_{\rm tot} = \sum_i a_i\, y_i$ by adding together the linear abundances $Z_{\rm C, \it i}$ in the same linear combination ($Z_{\rm C, tot} = \sum a_i\,Z_i$). 

There are some limitations to the process-tracking approximation. Note that many other GCE parameters are non-linear with abundance and require full multi-zone simulations, such as star formation history, outflows, and migration prescriptions. 
Also note that metallicity-dependent yields introduce a second-order effect (metallicity depends on total yields which depend on metallicity), but for small changes to total yields, this effect should be small.

Our first step is to run a multi-zone model tracking the abundances of each process we are interested in. 
To use all the information available for [C/Mg] trends with [Mg/Fe] and [Mg/H], we calculate the mean C abundance for each 2D bin in [Mg/Fe] and [Mg/H] for both the data and the model. We add Gaussian-distributed measurement uncertainties to the model's stars as described in the Appendix (Eq.~\ref{eq:uncertainties}).  We chose to use bins of a constant width of 0.04 dex, ranging from [Mg/H] of -0.5 to 0.5 and [Mg/Fe] of -0.1 to 0.4. We remove any 2D bin if fewer than 3 stars of the model or data fall in the bin.
We separate the C yield  into three different components:
\begin{enumerate}
    \item $\aagb$: Prefactor for an AGB yield table
    \item $\yl$: Constant CCSN yield 
    \item $\zcc$: Linear CCSN yield ($y = \zcc (Z/\Zo)$)
\end{enumerate}
$\yl$, representing the low-metallicity C yield, is related to the $\yo$ of Eq.~\ref{eq:y_cc} by $\yl + \zcc = \yo$.

We construct a likelihood based on the difference between the data and the model's mean C abundance in each bin. We use means since they are linear to linear combinations. Additionally, we work in linear abundance space for improved numerical stability. Given the predicted abundance for the model in a given bin $b$,  $Z_{\rm C, \it b}^{\rm model}$, the associated observed abundance, $Z_{\rm C, \it b}^{\rm obs}$, and the error on the mean $\sigma_b$, the (Gaussian) log likelihood is given by
\begin{equation} \label{eq:mcmc_likelihood}
    \log {\cal L} = \sum_b -\ln(\sigma_{b}) -\left(\frac{Z_{\rm C, \it b}^{\rm model} - Z_{{\rm C}, b}^{\rm obs}}{2\sigma_{b}}\right)^2 - \frac{1}{2}\log(2\pi).
\end{equation}
The total variance in each bin is calculated from the standard error on the mean of the observations in a bin $\sigma_{b, \rm obs}$, the standard error on the mean for each model component $i$, $\sigma_{b, i,\rm model}$, and a {\it systematic} uncertainty term $\sigma_{\rm sys}$. Altogether, 
\begin{equation}
    \sigma_{b}^2 = \sigma_{\rm sys}^2 + \sigma_{b,\rm\ obs}^2  +  \left(\sum_{i} a_i\, \sigma_{b,i,\ \rm model}\right)^2
\end{equation}
where $a_i$ is the associated coefficient ($\aagb$, $\yl$, $\zcc$) for each yield process.
We add the model standard deviations linearly since the C abundances are calculated from the same sample for each process.

When included, the $\sigma_{\rm sys}^2$ represents the typical systematic random uncertainty.
We consider models with both $\sigma_{\rm sys} = 0$ and 0.05 dex. While approximate, this value is similar to typical mean deviations between APOGEE and other surveys' C and Mg abundances \citep{hegedhus+2023, jonsson+2018} and discrepancies between APOGEE's reported abundance uncertainties compared to other measurements of dispersion \citep{mead+2024}. While systematic uncertainties are unlikely to be well-described by an independent, uncorrelated, constant-width normal distribution, we use this model as an order-of-magnitude illustration of the likely uncertainties of our results.

We adopt loose priors for each model parameter: $\aagb \sim N(1, 1)$, $\zcc \sim N(0, 10^{-3})$, and $\yl \sim N(2\times10^{-3}, 1\times10^{-3})$, where $N(\mu, \sigma)$ is a Gaussian distribution with mean $\mu$ and standard deviation $\sigma$.

We run the MCMC using Turing.jl \citep{turingjl} with a No-U-turn sampler (an adaptive Hamilton Monte-Carlo algorithm, \citealt{NUTS}) with an acceptance rate of 0.65. We combine 16 independent chains with 3,000 steps each for a total of 48,000 samples.
The median parameters derived from this model provide the yield choices for the AGB yield models shown in the left panel of Fig.~\ref{fig:sims_degens}.


\subsection{Yield inference results} \label{sec:mcmc_results}

Based on the procedure above, we derive our best-fitting (not fiducial) yield set. We find, for the \fruity{} AGB yield set,  $\aagb = \cfactor$, $\yo =22.3\times10^{-4}$, and $\zcc=7.9\times10^{-4}$. Instead, for the model where \fruity{} is shifted by a mass factor of 0.7, $\aagb = 2.34$, $\yo = 19.7\times 10^{-4}$ and $\zcc=3.2\times 10^{-4}$.  The fiducial yields enforce a low-metallicity [C/O] plateau of \about{-0.5} for better agreement in Section~\ref{sec:gas}. Table~\ref{tab:mcmc_results} presents the best-fitting parameters for each model or yield set considered here.

The left panel of Fig.~\ref{fig:mcmc_ytot} shows the inferred total C yield for each AGB yield table, and the \fruity{} table shifted by a mass factor of 0.7. While there is some variability in the total C yield, all models predict a total C yield within a band of width 0.5 in $\Yct$ ($\approx0.05\,$dex). Thus, the choice of AGB yield table only slightly affects the inferred total yield, as we expect the \caah{} trend to tightly constrain the total C yield (see Section~\ref{sec:yield_variations}).


The middle panel of Fig.~\ref{fig:mcmc_ytot} shows the inferred AGB fraction (Eq.~\ref{eq:f_agb}) at solar metallicity for each model. No model predicts a median $\fagb > 0.3$ and the 98th percentile upper-limits are always below $\fagb=0.4$. All models except \aton{} predict that at least $\approx 8$ per cent of solar C comes from AGB stars (from the 2nd percentile lower-limits). The SFH and yield scale have little impact on the inferred $\fagb$. Across all models considered here, we infer a minority role in AGB C production at solar metallicity.

The right panel of Fig.~\ref{fig:mcmc_ytot} compares the inferred scaling of AGB yields, $\aagb$. Given our yield scale, most AGB yield tables naturally produce near the best-fitting amount of AGB C, within a factor of ${\sim}2$. \monash{} predicts near the perfect amount of C (but see also discussion in Section~\ref{sec:agb_results}).
However, if the yield scale is increased \citep[e.g., as advocated in][]{james+24}, the required AGB C production increases accordingly. This is illustrated by the `doubled yields' model, which doubles yields and about doubles outflows. While $\fagb{}$ remains similar to the \fruity{} model, the ideal $\aagb$ doubles (see discussion in Section~\ref{sec:outflows}).

By including a $\sigma_{\rm sys}$ term, the distributions of $\fagb$, $\aagb$ and CC yield parameters all widen without changing our conclusions. Effectively, $\sigma_{\rm sys}$ reduces the weight of abundance differences between bins. Systematic uncertainties likely dominate the uncertainty budget in this analysis.

Finally, the choice of the Fe \ia{} DTD directly impacts our conclusions.  From the right panel of Fig.~\ref{fig:mcmc_ytot}, we note that increasing the SN Ia Fe yield by a factor of 1.2 (and decreasing the CC Fe yield to maintain the same total Fe production) results in a similar increase in the inferred $\fagb$. Increasing the SN Ia contribution to Fe stretches the trends in [Mg/Fe], causing [C/Mg] to flatten with [Mg/Fe] unless the delayed C yield is also increased. In this framework, constraints on delayed C contributions are limited by our understanding of delayed Fe production.


\begin{figure*}
    \centering
    \includegraphics[]{figures/mcmc_y_tot.pdf}
    \includegraphics[]{figures/mcmc_fagb.pdf}
    
    \caption[]{
        \textbf{Left:} The population-averaged yield ratio, $\Yct / \Ymg$, based on our MCMC fits to the [C/Mg]-[Mg/H]-[Mg/Fe] relation. We also show individual samples from the \fruity{} MCMC model.
        \textbf{Middle:} Posterior distribution of $\fagb$ from MCMC samples for each model. We show models without $\sigma_{\rm sys}$ (circles) and with $\sigma_{\rm sys}=0.05$\,dex additional uncertainty (triangles). In each case, the thick line is the 16th-94th percentile range and the thin line is the 2nd-98th percentile range.         \textbf{Right:} Similar to the middle panel except in terms of $\aagb$, the AGB table multiplication factor. The vertical line marks $\aagb=1$, corresponding to unscaled yields. }
    
    \label{fig:mcmc_ytot}
\end{figure*}




\section{Gas-Phase Abundances}\label{sec:gas}

\begin{figure*}
\centering
\includegraphics[]{figures/summary.pdf}
\caption[]{
Gas-phase C abundances. 
We plot the present-day gas-phase abundances predicted by our fiducial model as a thick blue line and the evolution of the $R=8$ kpc zone as a solid black line.
The black dotted line is a simple, one-zone model for a GSE-like dwarf galaxy.
Points represent measurements for MW stars (yellow stars), MW \Hii{} regions (RLs, orange pentagons), extragalactic \Hii{} Regions RLs (green empty diamonds), extragalactic \Hii{} regions from CELs (green full diamonds), high redshift galaxies (pink squares), damped Lyman-$\alpha$ systems (orange triangles),  and the low-$\alpha$ APOGEE subgiant sample we used here (purple circles). 
The points with error bars show representative median uncertainties for their associated population. Six measurements based on CEL or in DLAs (with large uncertainties) fall above or below the axis limits.

Data for Milky Way stars are from \citet[][]{amarsi+19},
MW \Hii{} regions from \citet[][]{mendez-delgado+22, esteban+05, esteban+13}, 
extragalactic RL \Hii{} regions from \citet[][]{peimbert+05, skillman+20, toribio-san-cipriano+16, toribio-san-cipriano+17, esteban+14, esteban+09}, 
extragalactic CEL \Hii{} regions from \citet[][]{garnett+95, senchyna+17, izotov+thuan99, garnett+99, berg+16, berg+19, pena-guerrero+17}, 
high redshift galaxies from \citet[][]{steidel+16, stark+14, matthee+21, mainali+20, jones+23, amorin+17, iani+23, james+14, erb+10, bayliss+14, berg+18, christensen+12, arellano-cordova+2022}, and
DLAs from \citet[][]{omera+01, cooke+14, welsh+22, ellison+10, welsh+20, cooke+18, riemer-sorensen+17, DZ+03, cooke+17, cooke+11, dutta+14, morrison+16, srianand+10, pettini+08, kislitsyn+24, cooke+15}.
}

\label{fig:gas_phase}
\end{figure*}


As a final test of our model, we compare the predictions against C abundances
in the gas phase. We consider measurements in Galactic and extragalactic \Hii{} regions, Damped Lyman-$\alpha$ systems\footnote{DLAs are gas clouds observed as absorption spectra in front of background quasars}, and Milky Way halo main-sequence stars.
While we used Mg as our representative alpha element in our APOGEE sample, we shift focus to O in this Section because O is more readily observed in the gas phase.
C abundances are challenging to measure in \Hii{} regions because C lacks strong recombination lines (RL),  and its collisionally excited lines (CEL) fall in the far ultraviolet without nearby reference H lines \citep[][]{skillman+20}.
%Furthermore, CEL and RL derived abundances are systematically discrepant by \about{0.5}\,dex \citep{GR07}.
Metals may also be trapped in dust grains or in unobserved ionization states, requiring model-dependent corrections \citep[e.g.,][]{MM19}.
We will see below that, despite these challenges, a global trend in [C/O] with metallicity nevertheless emerges.
 % DLAs, on the other hand, are relatively precise because these regions are lower-ionization, have a well-defined region (column density), and often have high-quality spectra covering rest-frame UV and optical {\color{red} CITE/verify}.

Fig.~\ref{fig:gas_phase} compiles literature measurements of [C/O]. The \Hii{} regions span a wide range of host galaxies: from the Milky Way and nearby spiral galaxies, to blue compact dwarf galaxies, to high-redshift star-forming and dwarf galaxies. We also include a sample of thick disk and halo stars for reference. 
Near solar metallicity, most measurements have ${\rm [C/O]} \approx 0$.
Below solar metallicity, [C/O] appears to follow a non-monotonic trend, reaching a minimum of $\co  \approx -0.6$ around $\oh \approx -1$, and possibly increasing again at the very lowest metallicities. 




To better represent the evolution of low-metallicity and dwarf galaxy environments, we construct an example {\it Gaia}-Sausage Enceladus (GSE, \citealt{meza+05, belokurov+18, helmi18}) --like model. This model is a single-zone model,  evolving one homogeneous gas supply. 
We use the same yields as our fiducial multi-zone model.
Our GSE-like model has a constant mass loading of $\eta=5.74$, total star formation time of 10.73 Gyr, a constant star formation efficiency time-scales of 26.60 Gyr, and an exponential infall history $\dot \Sigma_{\rm in} = \exp(-t / 2.18\,{\rm Gyr})$ (in contrast to star formation rate specification for our fiducial model). In summary, the GSE-like model compared to our fiducial MW model does not include radial migration and has a more rapid star formation history, elevated outflows, and lower star formation efficiency.

The gas-phase C abundances reveal a breakdown of our fiducial yield prescription. While the fiducial model sits well within the scatter of C/O ratios observed in near-solar (low-redshift) \Hii{} regions, the evolution of the solar zone only agrees with the highest measurements of [C/O] at lower metallicities ${\rm [O/H]} \sim -1$. The CCSN-only, low-metallicity plateau of [C/O] in the fiducial model is $\approx -0.5$. No value of [C/O] below about -0.5 would be consistent with this model. Furthermore, our GSE-like model consistently predicts higher [C/O] abundances. Because the star formation efficiency is much lower in this model, the contribution due to delayed enrichment will appear at lower metallicities. As a result, even at ${\rm [O/H]} \sim -1.5$, delayed C enrichment appears, raising the [C/O] ratio above most observations. This model is a relatively poor fit to the gas-phase data. We note that our subgiant sample only extends as low as a metallicity of ${\rm [O/H]} \sim -0.4$, so any application of the model to gas-phase requires substantial extrapolation. Our best-fitting yield models (to subgiants) prefer lower $\fagb{}$ and consequently higher low-metallicity [C/O] plateaus, worsening agreement.

One possible remedy would be to decrease our assumed minimum CCSN yield $y_{\rm low}$, bringing the low-metallicity plateau into better agreement with observations. A lower $y_{\rm low}$ also requires a higher $\fagb{}$ to reach the observed [C/Mg] near solar metallicity. A slightly higher value of $\fagb{}$ will lower the low-metallicity plateau into better agreement with observations. However, a high $\fagb{}$ model would be in tension with the subgiant abundance trends. Such a model should produce stars with [C/O] near the plateau value in the early enrichment history of the Milky Way, observed as very low C but high-$\alpha$ stars (see evolution tracks in Fig.~\ref{fig:c_evo} and related models from Fig.~\ref{fig:zeta_f}). Because there are no subgiants with [C/Mg] abundances below \about{-0.4}, it is unlikely a high $\fagb{}$ model reconciles the gas-phase and stellar abundance trends. But, if C production is much more delayed than current AGB models predict, [C/Mg] may remain lower for longer than for our fiducial yields.

Another possibility is that the massive star production of C (or O) exhibits a complex metallicity dependence. The increasing [C/O] abundances at the very lowest metallicities as observed in DLAs already hint at a more nuanced C nucleosynthetic landscape. Given the abundance trends observed in Fig.~\ref{fig:gas_phase}, we propose the following possibility for C production. (1) At the very lowest metallicities, massive stars may produce copious amounts of C through rotation, alternative IMF, or differing supernova mechanisms. 
%(Umeda & Nomoto 2003, 2005; Chieffi
%& Limongi 2004; Iwamoto et al. 2005; Meynet et al. 2006,
%2010; Nomoto et al. 2006; Tominaga et al. 2007, 2014;
%Heger & Woosley 2010; Limongi & Chieffi 2012; Ishigaki
%et al. 2014; Choplin et al. 2016; Salvadori et al. 2016;
%Kobayashi et al. 2020).
This would now be observed as CEMP-no stars \citep[e.g., review and references in][]{FN15} and the elevated C abundances of DLAs. (2) C production sharply drops as metallicity increases, reaching a minimum between [O/H] of -3 and -1.5. Stars and (dwarf) galaxies with the lowest C/O ratios would be formed in this stage. (3) As metallicity increases, massive star C yields steeply increase. In addition, C production from delayed AGB stars becomes more and more important, accelerating an increase of C abundances relative to O on approach to solar metallicity. (4) Finally, in the regime of our own galaxy, the rapid increase of CCSN production of C may temper, procuring the gently sloping trend apparent in subgiants today. 


\citet{berg+19} consider an alternative scenario for the chemical evolution of C in dwarf galaxies. Their models include initially high C/O ratios from Population III stars, which decline with metallicity due to Population II enrichment.
Later, in a bursty star formation history, [C/O]-[O/H] follows a "zig-zag" pattern due to alternating periods of \cc{} and \agb{} dominated nucleosynthetic enrichment (see their figure 11).
Scatter in C/O then arises from a combination of varying star formation histories and changing effective oxygen yields (i.e., different supernova entrainment factors). 

\section{Discussion \& Conclusions}\label{sec:conclusions}


Building on the constraints on N production by \citet{james+23}, we quantify the impact of C yield assumptions on Milky Way GCE models. We use \citepos{jack} sample of APOGEE subgiants as our primary observational benchmark, as subgiant atmospheres best reflect their birth C abundances among spectral types (see discussion in Section~\ref{sec:data_selection}).
In our fiducial model, the evolution of [C/Mg] initially increases with time due to the metallicity-dependent C yields from massive stars. Later, AGB stars contribute additional C, causing a sharp rise in C with metallicity. However, the chemical history is only indirectly related to the stellar abundance trends.


The \caah{} relation in low-$\alpha$ stars arises as a superposition of the endpoints of evolutionary sequences traced out by different Galactic regions (see Fig.~\ref{fig:c_evo}). As a result, the \caah{} trend is most strongly tied to the total C yield (relative to Mg) at each metallicity [Mg/H]. Because all AGB yield tables we consider here predict a declining C yield with increasing metallicity, the \caah{} trend implies that the CCSN yield must increase with metallicity. This could be due to the heightened metallicity-dependent mass-loss in the rotating models of \citet{LC18}. The C versus [Mg/H] relation alone, however, is unable to provide substantial information on the delayed relative to prompt production of C from massive or low-intermediate mass stars. On the other hand, the \caafe{} relation, at a given metallicity, is most sensitive to the amount of delayed, AGB C production. In addition, the shape of the [C/Mg] abundance trend with [Mg/Fe] can constrain the nature of the DTD of C.


From the combined constraints of the [C/Mg] trend with metallicity and [$\alpha$/Fe], we have inferred possible observationally-consistent combinations of yields. In all cases, we find that $\Yct / \Ymg \approx 4.2 \pm 0.2$ at solar metallicity, with total C production increasing with increasing metallicity. We also show that low-intermediate mass AGB stars likely produce a fraction of between 0.10 and 0.40 of solar C, across GCE assumptions and AGB yield tables.

Given our yield scale, we find most AGB yield tables are within ${\sim}2$ times the inferred AGB C production. We find that the best-fitting models require between about 0.6 and 2 times more C than predicted by the AGB table. However, if the yield scale is higher than ours, the AGB C yield should be similarly amplified. 


As a consequence of massive star enrichment dominating the C production in our models, our conclusions are relatively insensitive to the choice of AGB yield model. Of the yield tables tested here, \fruity{} and \nugrid{} better describe \caafe{} trend, as the production of C is too rapid from \monash{} and \aton{} near solar metallicity. However, all AGB yield tables predict a \caafe{} relation that is concave down, while the observed relation is linear. Based on this discrepancy, C may be more efficiently produced in lower mass AGB stars than predicted by stellar models (see Fig.~\ref{fig:sims_degens}), which would increase characteristic delay times and linearize the \caafe{} trend. This discrepancy could also be resolved by a less extended DTD for SN Ia.


Comparing our models with measurements of C abundances in the gas phase available in the literature reveals a potential shortcoming of our C yield prescription in the ${\rm [O/H]} \lesssim -1$ regime. \Hii{} regions at these metallicities typically have $\co \approx -0.6$ but with substantial scatter (see Fig.~\ref{fig:gas_phase}). Our models predict $\co \approx -0.5$ at low metallicity, struggling to explain the lowest [C/O] measurements. Dwarf galaxy GCE models tuned to GSE fare even worse, indicating that different galactic environments are not responsible for the difference. Instead, either a larger AGB contribution to C is required, disfavoured by the subgiant trends, or a complex, non-monotonic massive-star production of C is needed. 

As in \citet{james+23}, our models constrain relative as opposed to absolute yields due to the degeneracy between the overall scale and the strength of outflows \citep[e.g.,][]{hartwick1976,james+23, sandford+24}. Rescaling both parameters by similar multiplicative factors leaves the predicted \caah{} relation largely unchanged to first order (see Fig.~\ref{fig:sims_degens}). Breaking this degeneracy requires either age measurements to pin down enrichment time-scales \citep{james+24}, chemical species produced during Big Bang Nucleosynthesis present in accreting gas \citep{cooke+2022}, or independent constraints from observations of SN \citep[e.g.,][]{rodriguez+23,david_fe}. However, our constraints on the ratio of C/Mg yields, its metallicity dependence, and the AGB contribution to C are robust, as we only consider C through yield ratios. 

As we constrain the yield ratio, variations in the Mg yield may help explain the [C/Mg] trends. While we focus on variations on the C yield alone, our constraint is nevertheless on the C/Mg yield ratio. $\alpha$-elements like Mg and O, produced primarily in CCSN, are typically expected and observed to have mostly metallicity-independent yields \citep[e.g.,][]{weinberg+19}. Although, the details of the origin of the metallicity dependence of C and Mg remain uncertain.

While we focus on median trends, the scatter of the trends may include additional information about C production. We find that our model predicts a similar scatter as observed in subgiants in the \caafe{} and \caah{} trends (not shown). Further investigation into the detailed distribution of C abundance ratios with metallicity and $[\alpha/{\rm Fe}]$ may reveal more information about the origin of the elements.

Our results in this paper demonstrate the utility of empirically calibrated stellar yields. Due to the sensitivity of nucleosynthetic yields to poorly understood stellar evolution processes, such as mass loss and convection, these results provide a useful benchmark for stellar models (see discussion in, e.g., \citealt{gil-pons+2022}). With larger samples and more reliable abundance measurements from upcoming spectroscopic surveys, such as SDSS-V's Milky Way Mapper program \citep{kollmeier+25}, our understanding of metal production and the assembly history of our Galaxy will sharpen.
Observing C across a range of environments at higher precision will allow for yet more detailed understanding of C nucleosynthesis, creating stringent tests for stellar evolution theory and refining our understanding of the chemical evolution of the Universe. 


 
\section*{Acknowledgements}
This paper uses \apogee\ data \citep{apogee_instrumentation, apogee17, aspcap}. \apogee{} is  part of SDSS-IV \citep{sloan_telescope, sdss_iv_overview, sdss17}.

Software that has contributed to this work included  
\VICE~\citep{JW20, james+21},
\textsc{matplotlib} \citep{matplotlib},
\textsc{scipy} \citep{scipy},
\textsc{IPython} \citep{ipy},
\textsc{pandas} \citep{pandas},
\textsc{numpy} \citep{numpy},
\textsc{astropy} \citep{astropy:2013, astropy:2018, astropy:2022},
and 
\textsc{seaborn} \citep{seaborn}
.
Additionally, we thank \citet{OhioSupercomputerCenter1987} for the use of its facilities for the simulations. 



% Funding for the Sloan Digital Sky 
% Survey IV has been provided by the 
% Alfred P. Sloan Foundation, the U.S. 
% Department of Energy Office of 
% Science, and the Participating 
% Institutions. 
% 
% SDSS-IV acknowledges support and 
% resources from the Center for High 
% Performance Computing  at the 
% University of Utah. The SDSS 
% website is www.sdss4.org.
% 
% SDSS-IV is managed by the 
% Astrophysical Research Consortium 
% for the Participating Institutions 
% of the SDSS Collaboration including 
% the Brazilian Participation Group, 
% the Carnegie Institution for Science, 
% Carnegie Mellon University, Center for 
% Astrophysics | Harvard \& 
% Smithsonian, the Chilean Participation 
% Group, the French Participation Group, 
% Instituto de Astrof\'isica de 
% Canarias, The Johns Hopkins 
% University, Kavli Institute for the 
% Physics and Mathematics of the 
% Universe (IPMU) / University of 
% Tokyo, the Korean Participation Group, 
% Lawrence Berkeley National Laboratory, 
% Leibniz Institut f\"ur Astrophysik 
% Potsdam (AIP),  Max-Planck-Institut 
% f\"ur Astronomie (MPIA Heidelberg), 
% Max-Planck-Institut f\"ur 
% Astrophysik (MPA Garching), 
% Max-Planck-Institut f\"ur 
% Extraterrestrische Physik (MPE), 
% National Astronomical Observatories of 
% China, New Mexico State University, 
% New York University, University of 
% Notre Dame, Observat\'ario 
% Nacional / MCTI, The Ohio State 
% University, Pennsylvania State 
% University, Shanghai 
% Astronomical Observatory, United 
% Kingdom Participation Group, 
% Universidad Nacional Aut\'onoma 
% de M\'exico, University of Arizona, 
% University of Colorado Boulder, 
% University of Oxford, University of 
% Portsmouth, University of Utah, 
% University of Virginia, University 
% of Washington, University of 
% Wisconsin, Vanderbilt University, 
% and Yale University.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Data Availability}

Data and code used in this paper are happily available upon request.

%%%%%%%%%%%%%%%%%%%% REFERENCES %%%%%%%%%%%%%%%%%%
\bibliographystyle{mnras}
\bibliography{main}


%%%%%%%%%%%%%%%%% APPENDICES %%%%%%%%%%%%%%%%%%%%%

\appendix


\section{Model parameters and details}


\begin{table}
	\centering
        \caption[]{Description of the yields used for models presented in this paper.}
	\label{tab:model_parameters}

	\begin{tabular}{l l l l l l l l l}
		\hline
            name & $\aagb$ & $\ycagb$ & $\yo/10^{-4}$ & $\zcc/10^{-4}$ \\ 
            \hline
            fiducial & 2.57 & fruity & 18.7 & 7.9 \\
            $\zcc=0.0004$ & 2.57 & fruity & 18.7 & 4.0 \\
            $\zcc=0.0012$ & 2.57 & fruity & 18.7 & 11.9 \\
            $\fagb = 0$ & 0.0 & fruity & 27.1 & 7.9 \\
            $\fagb = 0.5$ & 4.36 & fruity & 13.3 & 7.9 \\
            lower $\fagb$, $\zcc$ & 0 & fruity & 27.9 & 4.1 \\
            higher $\fagb$, $\zcc$ & 4.36 & fruity & 12.1 & 12.1 \\
            \fruity{} & 1.55 & fruity & 22.3 & 7.2 \\
            \aton{} & 1.07 & aton & 26.2 &  11.3 \\
            \monash{} & 1.12 & monash & 23.7 & 10.9 \\
            \nugrid{} & 0.59 & nugrid & 22.3 & 4.5 \\
            \fruity{} shifted & 1.29 & fruity(m/0.7) & 23.3 & 4.6 \\
            mass shift 0.5 & 2.98 & fruity(m/0.5)  & 22.1 & 14.5 \\
            mass shift 0.7 & 2.34 & fruity(m/0.7) & 19.7 & 3.2 \\
            mass shift 1.5 & 2.71 & fruity(m/1.5) & 18.6 & 8.5 \\
		\hline
	\end{tabular}
\end{table}


\ref{tab:model_parameters} lists the parameters of the models used in this paper.

For our added scatter, we use the polynomial fits to the reported internal APOGEE error with metallicity. In detail, these polynomials should also vary with surface gravity and effective temperature. However, as all of our stars are subgiants, these effects should be smaller. We also use $x={\rm [Fe/H]}$ for brevity.
\begin{subequations}
\label{eq:uncertainties}
\begin{align}
    \delta {\rm [Mg/H]} &= 0.0652\,x^2 + 0.00522\,x + 0.0338 \\
    \delta {\rm [Mg/Fe]} &= 0.00793\,x^2 - 0.00802\,x + 0.0138 \\
    \delta {\rm [C/Mg]} &= -0.0378\,x + 0.03506 
\end{align}
\end{subequations}



\section{NuGrid yield tables} \label{sec:nugrid_yields}
In this Section, we present updated calculations of the \citet{battino+19, battino+21} yield tables and describe their incorporation into \VICE. These models use the NuGrid MPPNP post-processing toolkit on models run through {\rm mesa} stellar evolution.

\citet{battino+19, battino+21} update the \citet{ritter+18} yield models with new reaction rates and increased mixing. These changes allow for better production of {\it s}--process isotopes in their AGB stars, and are recommended for the masses they update. However, between these models, the only updates are for masses 2 and $3\,\Mo$ at metallicities $Z=0.01, 0.02, 0.001, 0.002$. 

Because the yield tables included in \citep{battino+19, battino+21} are inconsistent with the \citet{ritter+18} definitions of yields, we recalculate these yields from the publicly available data on \url{https://astrohub.uvic.ca}. 

The total ejected mass of $X$ from an AGB star is given by 
\begin{equation}
    M_{X, \rm ej} = \int Z_{X, \rm surf}(t) \dot{m}(t)\ dt 
\end{equation}
where $Z_{X, \rm surf}$ is the surface abundance of $X$, $\dot m$ is the mass loss rate, and the integral is taken over the entire evolution. 
One complication is that {\sc mesa} stellar evolution stops before the end of the AGB phase due to instabilities during the transition to the planetary nebulae. 
As a result, the practical calculation is to combine both the ejected surface mass at each time step and the remaining mass not yet ejected:  
\begin{subequations}
    \begin{align}
        M_{X, \rm ej} &= Z_{\rm X, surf, end} (m_{\rm end} - m_{\rm rem}) \\ 
                      &+ \sum_i \frac{1}{2} (Z_X(t_i) - Z_X(t_{i+1}))\ (m(t_i) - m(t_{i+1}))
    \end{align}
\end{subequations}
where $m_{\rm end}$ and $Z_{X, \rm surf, end}$ are the final mass and surface abundance of $X$ at the end of {\sc mesa} evolution, $m_{\rm rem}$ is the mass remaining in the star at the end of {\sc mesa} evolution, and the sum is taken over all time steps in the {\sc mesa} output. We use the final H-free mass as the remnant mass. 

We use the \citet{ritter+18} tables from $M_{X, \rm ej}$, which we can reproduce from the same methods as above. Finally, the $p_{X}$ yields are calculated from $M_{\rm X, ej}$. 



\section{MCMC additional results}

Fig.~\ref{fig:mcmc} shows the distribution and correlation of each parameter in our MCMC model fit to the C yields described in Section~\ref{sec:nucleosynthesis}, assuming the \fruity{} AGB table. Each parameter is relatively well-constrained. The most prominent correlation, between $\yl$ and $\aagb$, represents the constraint on the equilibrium abundance of C near solar. Another clear correlation, between $\yl$ and $\zcc$, is related to the solar yield constraint as well, allowing a narrow range of $\zcc$ values while retaining the solar $\yo = \yl + \zcc$ yield.

Table~\ref{tab:mcmc_results} contains the resulting posterior distributions for each parameter for each AGB model and GCE parameter choice discussed here. 

\begin{table*}
    \caption{
        Best-fit parameters (medians and 16-84th percentile ranges) from MCMC analysis for various models discussed.
        The columns are:  the model name, best-fitting log posterior probability $\log p$, AGB scaling $\aagb$, CCSN low-metallicity yield $\yl$, the CCSN yield slope $\zcc$, the AGB fraction $\fagb$, and the total C yield at solar metallicity $\Yct$.
    }
    \label{tab:mcmc_results}

{ 
\renewcommand{\baselinestretch}{1.2}
    \begin{tabular}{l l l l l l l l l l l} 
    \hline
    model            %& $\chi2$  
    & $\log p$ & $\aagb$ & $\yl/10^{-4}$ & $\zcc/10^{-4}$ &  $\fagb$ & $\Yct/10^{-4}$\\    %
\hline
\fruity          &  -506.85 & $1.56^{+0.04}_{-0.04}$  &  $15.1^{+0.2}_{-0.2}$  &  $7.2^{+0.1}_{-0.1}$  &  $0.18^{+0.00}_{-0.00}$  &  $27.1^{+0.0}_{-0.0}$\\ 
\aton            &  -492.15 & $1.07^{+0.03}_{-0.03}$  &  $14.9^{+0.2}_{-0.2}$  &  $11.3^{+0.2}_{-0.2}$  &  $-0.00^{+0.00}_{-0.00}$  &  $26.2^{+0.1}_{-0.1}$\\ 
\monash          &  -768.25 & $1.12^{+0.04}_{-0.04}$  &  $12.8^{+0.3}_{-0.3}$  &  $10.8^{+0.2}_{-0.2}$  &  $0.12^{+0.00}_{-0.00}$  &  $27.0^{+0.0}_{-0.0}$\\ 
\nugrid          &  -716.22 & $0.59^{+0.02}_{-0.02}$  &  $17.8^{+0.1}_{-0.1}$  &  $4.5^{+0.1}_{-0.1}$  &  $0.20^{+0.01}_{-0.01}$  &  $27.8^{+0.0}_{-0.0}$\\ 
\fruity\ shifted    &  {\bf -298.11} & $1.29^{+0.03}_{-0.03}$  &  $18.7^{+0.1}_{-0.1}$  &  $4.6^{+0.1}_{-0.1}$  &  $0.17^{+0.00}_{-0.00}$  &  $28.0^{+0.0}_{-0.0}$\\ 
doubled yields (and $\eta$) &  -492.95 & $1.53^{+0.04}_{-0.04}$  &  $15.3^{+0.2}_{-0.2}$  &  $7.0^{+0.1}_{-0.1}$  &  $0.18^{+0.00}_{-0.00}$  &  $27.1^{+0.0}_{-0.0}$\\ 
lateburst        &  -453.73 & $1.90^{+0.05}_{-0.05}$  &  $14.5^{+0.2}_{-0.2}$  &  $6.5^{+0.1}_{-0.1}$  &  $0.22^{+0.01}_{-0.01}$  &  $26.9^{+0.0}_{-0.0}$\\ 
twoinfall        &  -497.75 & $1.55^{+0.03}_{-0.03}$  &  $15.5^{+0.1}_{-0.1}$  &  $6.9^{+0.1}_{-0.1}$  &  $0.18^{+0.00}_{-0.00}$  &  $27.2^{+0.0}_{-0.0}$\\ 
higher SN Ia       &  -482.67 & $2.15^{+0.04}_{-0.04}$  &  $11.4^{+0.2}_{-0.2}$  &  $8.4^{+0.1}_{-0.1}$  &  $0.25^{+0.01}_{-0.01}$  &  $26.5^{+0.0}_{-0.0}$\\ 
\hline
{\bf including $\sigma_{\rm sys}$}: \\
\fruity          &   -49.21 & $1.68^{+0.19}_{-0.20}$  &  $16.6^{+0.7}_{-0.7}$  &  $5.0^{+0.8}_{-0.8}$  &  $0.19^{+0.02}_{-0.02}$  &  $26.9^{+0.4}_{-0.4}$\\ 
\aton            &   -54.01 & $0.97^{+0.12}_{-0.12}$  &  $17.0^{+0.7}_{-0.7}$  &  $9.1^{+0.8}_{-0.8}$  &  $-0.00^{+0.00}_{-0.00}$  &  $26.1^{+0.5}_{-0.5}$\\ 
\monash          &   -60.05 & $1.06^{+0.15}_{-0.15}$  &  $15.0^{+1.0}_{-1.0}$  &  $8.6^{+0.8}_{-0.8}$  &  $0.12^{+0.02}_{-0.02}$  &  $26.8^{+0.4}_{-0.4}$\\ 
\nugrid          &   -52.04 & $0.83^{+0.10}_{-0.10}$  &  $19.0^{+0.6}_{-0.6}$  &  $0.9^{+1.0}_{-1.0}$  &  $0.28^{+0.03}_{-0.03}$  &  $27.6^{+0.4}_{-0.4}$\\ 
\fruity\ shifted    &   {\bf -44.75} & $1.57^{+0.18}_{-0.18}$  &  $19.7^{+0.5}_{-0.5}$  &  $2.7^{+0.9}_{-0.9}$  &  $0.20^{+0.02}_{-0.02}$  &  $28.1^{+0.4}_{-0.4}$\\
\hline
\end{tabular}

}
    
\end{table*}

\begin{figure}
\centering
\includegraphics{figures/mcmc_corner.pdf}
\caption[]{
A corner plot of the posterior samples from the MCMC simulation for the analytic model fit to the binned mean trends.
$\aagb$ represents the scale factor for the AGB yields, and $\yl$, $\zcc$ represent the constant and linear components of the CCSN yield. 
See Section~\ref{sec:mcmc_methods} for a description of the methods.

}

\label{fig:mcmc}
\end{figure}


\bsp	% typesetting comment
\label{lastpage}
\end{document}





